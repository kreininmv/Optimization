\section{Conjugate functions}

\subsection{Problem № 1} Find $f^*(y)$, if $f(x) = p \cdot x - q$

\underline{\textbf{Solution:}}

\begin{equation*}
    f^*(y) = \sup_{x \in dom(f)} \left( 
    \langle y, x \rangle - f(x) \right) = \sup_{x \in \mathbf{R}} \left( xy - px + q\right)
\end{equation*}

$g(x) = xy - px + q$, $\nabla g(x) = y - p$
And we can easy get a answer:

\underline{\textbf{Answer:}} $f^*(y) = \begin{cases}
   q, y = p \\
   +\inf , y \ne p.
 \end{cases}$

\subsection{Problem №2}
Find $f^*(y), if f(x) = \frac{1}{2}x^TAx$, $A \in \mathbf{S}_{++}^n$
\underline{\textbf{Solution:}}

\begin{equation*}
    f^*(y) = \sup_{x \in dom(f)} \left( 
    \langle y, x \rangle - f(x) \right) = \sup_{x \in \mathbf{R}^n} \left( y^Tx - \frac{1}{2}x^TAx\right)
\end{equation*}

$g(x) = y^Tx - \frac{1}{2}x^TAx$

$\nabla g(x) = y^T - xA )$, because $A \in \mathbf{S}_{++}^n$
$y = A^Tx$

\begin{equation*}
    f^*(y) = \sup_{x \in \mathbf{R}^n}\left( (A^Tx)^Tx - \frac{1}{2}x^TAX\right) = \sup_{x \in \mathbf{R}^n}\left( \frac{1}{2}x^TAX\right) = +\inf
\end{equation*}

\underline{\textbf{Answer:}} $f^*(y) = +inf$

\subsection{Problem №3}
Find $f^*(y), if f(x) = log \left( \sum\limits_{i=1}^n e^{x_i}\right)$

\underline{\textbf{Solution:}}

\begin{equation*}
    f^*(y) = \sup_{x \in dom(f)} \left( 
    \langle y, x \rangle - f(x) \right) = \sup_{x \in \mathbf{R}^n} \left( y^Tx - log \left( \sum\limits_{i=1}^n e^{x_i}\right)
    \right)
\end{equation*}

$d(y^tx - f(x)) = \langle y, dx \rangle - \frac{\langle e^x, dx \rangle}{\sum\limits_{i=1}^n e^{x_i}}=0$,  $e^x$ in meaning that it equals $(e^{x_1}, e^{x_2}, ..., e^{x_n})$.

And we get that: $y = \frac{e^x}{\sum\limits_{i=1}^n e^{x_i}}$

\begin{equation*}
    f^*(y) = \sup_{x \in \mathbf{R}^n} \left(\sum\limits_{i=1}^n y_ix_i - log \left( \sum\limits_{i=1}^n e^{x_i}\right) \right) = \sup_{x \in \mathbf{R}^n} \left(\sum\limits_{i=1}^n log(e^{y_ix_i}) - log \left( \sum\limits_{i=1}^n e^{x_i}\right) \right) 
\end{equation*}

\begin{equation*}
    f^*(y) = \sum\limits_{i=1}^n log \left( \frac{e^{y_i}e^{x_i}}{\sum\limits_{k=1}^n e^{x_k}} \right) = \sum\limits_{i=1}^n log \left( e^{y_i}y_i \right) = \sum\limits_{i=1}^n y_i log(y_i) 
\end{equation*}

Oh wow, it's crossentropyloss ( $y \succ 0$, $y^T\mathbf{1} = 1$, so y - probability vector)


\underline{\textbf{Answer:}}

\subsection{Problem №4}
Prove, that if $f(x) = g(Ax),$ then $f^*(y) = g^*(A^{-T}y)$

\underline{\textbf{Solution:}}
\begin{equation*}
f^*(y) = \sup_{x \in \mathbf{R}^n}\left(y^Tx - f(x)  \right)
\end{equation*}

$y^Tdx - \nabla f(x)^Tdx = 0$, $y = \nabla f(x)$
\begin{equation*}
    f^*(y) \sup_{x \in \mathbf{R}^n} \left( (\nabla f(x))^Tx - f(x) \right)
\end{equation*}

The same way we can get:
%\[ \adjustlimits\\sup_{a\in A} \inf_{b\in B} \mathrm{d}(a,b) \]

\begin{equation*}
    g^*(y) = \sup_{x \in \mathbf{R}^n} \left( (\nabla g(x))^Tx - g(x) \right)
\end{equation*}

\begin{equation*}
    g^*(A^{-T}y) = \sup_{x \in \mathbf{R}^n} \left( (A^{-T}\nabla(g(x))^Tx - g(x) \right)
\end{equation*}

$x = Ax_1$

\begin{equation*}
    g^*(A^{-T}y) = \sup_{x_1 \in \mathbf{R}^n} \left( \nabla g(Ax_1)^T A^{-1}Ax_1 - g(Ax_1) \right) = \sup_{x_1 \in \mathbf{R}^n} \left( \nabla g(Ax_1)^Tx_1 - g(Ax_1)
    \right)
\end{equation*}

Because $g(Ax_1) = f(x_1)$, we can get:

\begin{equation*}
    g^*(A^{-T}y) = \sup_{x_1 \in \mathbf{R}^n} \left( \nabla f(x_1)^Tx_1 - f(x_1)\right) = f^*(y)
\end{equation*}
    
WOHOO!

\subsection{Problem №5}
Find $f^*(Y)$, if $f(X) = -\log( det X), X \in \mathbf{S}_{++}^n$

\underline{\textbf{Solution:}}

\begin{equation*}
    f^*(Y) = \sup_{x \in \mathbf{R}^{n \times n}} \left( \langle Y, X \rangle + \log(detX) \right)
\end{equation*}

$\langle Y, dX \rangle + \frac{1}{detX}d(detX) = \langle Y, dX \rangle + \frac{1}{detX}detX \langle X^{-T}, dX \rangle = 0$

And we get: $Y = - X^{-T}$, $X = -Y^{-T}$

\begin{equation*}
    f^*(Y) = \langle Y, - Y^{-T} \rangle + \log(det(-Y^{-1})) = tr(-E) + \log \left((-1)^n det(Y^{-1}) \right)
\end{equation*}

\begin{equation*}
    f^*(Y) = -n + \log \left( \frac{(-1)^n}{detY} \right)
\end{equation*}

\underline{\textbf{Answer:}}
$f^*(Y) = \log \left( \frac{(-1)^n}{detY} \right) - n$